<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario con Barra de Progreso</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light py-5">

<div class="container bg-white p-4 rounded shadow" style="max-width: 720px;">
  <h1 class="text-center mb-4">Formulario con Barra de Progreso</h1>

  <!-- Barra de progreso -->
  <div class="progress mb-4">
    <div id="barraProgreso" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
  </div>

  <div class="mb-3">
    <label for="nombre" class="form-label">Nombre:</label>
    <input type="text" class="form-control campo" id="nombre" placeholder="Ingresa tu nombre">
  </div>
  
  <div class="mb-3">
    <label for="imagen" class="form-label">Selecciona una imagen:</label>
    <input class="form-control" type="file" id="imagen" accept="image/*">
  </div>

  <div id="preview" class="text-center mb-3">
    <p class="text-muted">Aquí aparecerá la miniatura de la imagen seleccionada.</p>
  </div>

  <div class="mb-3">
    <label for="comentario" class="form-label">Comentario:</label>
    <textarea class="form-control campo" id="comentario" rows="3" placeholder="Escribe un comentario..."></textarea>
  </div>

  <div class="mb-3">
    <label for="colorFavorito" class="form-label">Color Favorito:</label>
    <select class="form-select campo" id="colorFavorito">
      <option value="">-- Selecciona un color --</option>
      <option value="Rojo">Rojo</option>
      <option value="Verde">Verde</option>
      <option value="Azul">Azul</option>
    </select>
  </div>

  <div class="row">
    <div class="col-md-6 mb-3">
      <label class="form-label d-block">Género:</label>
      <div class="form-check form-check-inline">
        <input class="form-check-input campo-radio" type="radio" id="masculino" name="genero" value="Masculino">
        <label class="form-check-label" for="masculino">Masculino</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input campo-radio" type="radio" id="femenino" name="genero" value="Femenino">
        <label class="form-check-label" for="femenino">Femenino</label>
      </div>
    </div>

    <div class="col-md-6 mb-3">
      <label class="form-label d-block">Intereses:</label>
      <div class="form-check form-check-inline">
        <input class="form-check-input campo-check" type="checkbox" id="interes1" value="Deportes">
        <label class="form-check-label" for="interes1">Deportes</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input campo-check" type="checkbox" id="interes2" value="Música">
        <label class="form-check-label" for="interes2">Música</label>
      </div>
    </div>
  </div>

  <div class="mb-3">
    <label for="edad" class="form-label">Edad:</label>
    <input type="number" class="form-control campo" id="edad" min="1" max="100" placeholder="Edad">
  </div>

  <button class="btn btn-primary">Enviar</button>
</div>

<script>
const campos = document.querySelectorAll('.campo');
const radios = document.querySelectorAll('.campo-radio');
const checks = document.querySelectorAll('.campo-check');
const barra = document.getElementById('barraProgreso');
const archivo = document.getElementById('imagen').files[0];

// Total de campos obligatorios a monitorear:
const totalCampos = campos.length + 1 + 1;  // +1 por radio, +1 por check

function actualizarProgreso() {
  let completados = 0;

  // Revisa inputs y selects
  campos.forEach(campo => {
    if (campo.value.trim() !== '') {
      completados++;
    }
  });

  // Revisa radio buttons (al menos uno seleccionado)
  const generoSeleccionado = document.querySelector('input[name="genero"]:checked');
  if (generoSeleccionado) {
    completados++;
  }

  // Revisa checkboxes (al menos uno seleccionado)
  const algunCheck = Array.from(checks).some(check => check.checked);
  if (algunCheck) {
    completados++;
  }

  const imagenSeleccionada = document.getElementById('imagen').files.length > 0;
  if (imagenSeleccionada) {
    completados++;
  }

  const porcentaje = Math.round((completados / totalCampos) * 100);

  barra.style.width = porcentaje + '%';
  barra.setAttribute('aria-valuenow', porcentaje);
  barra.textContent = porcentaje + '%';
}

// Asigna eventos
campos.forEach(campo => campo.addEventListener('input', actualizarProgreso));
radios.forEach(radio => radio.addEventListener('change', actualizarProgreso));
checks.forEach(check => check.addEventListener('change', actualizarProgreso));

document.getElementById('imagen').addEventListener('change', function(event) {
  const archivo = event.target.files[0];

  if (archivo) {
	// Mostrar la información completa en la consola
    console.log('Información del archivo seleccionado:');
    console.log('Nombre:', archivo.name);
    console.log('Tipo MIME:', archivo.type);
    console.log('Tamaño (bytes):', archivo.size);
    console.log('Última modificación:', new Date(archivo.lastModified));
    
	// Validamos que sea una imagen
    if (!archivo.type.startsWith('image/')) {
      alert('Por favor selecciona un archivo de imagen válido.');
      return;
    }

    const lector = new FileReader();

    lector.onload = function(e) {
      const preview = document.getElementById('preview');
      preview.innerHTML = `
        <p class="text-muted">Vista previa:</p>
        <img src="${e.target.result}" class="img-thumbnail mb-3" style="max-width: 300px;">
      `;
    };

    lector.readAsDataURL(archivo);
  } else {
    // Si no hay archivo seleccionado, limpiar la vista previa y ocultar el botón de descarga
    document.getElementById('preview').innerHTML = '<p class="text-muted">Aquí aparecerá la miniatura de la imagen seleccionada.</p>';
  }
});
</script>

</body>
</html>
